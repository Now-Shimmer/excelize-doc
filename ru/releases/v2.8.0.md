# Excelize v2.8.0

* Выйдет: 28 Август 2023 г.

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Критические изменения: переименуйте экспортированную переменную `ErrTableNameLength` в `ErrNameLength`
* Критические изменения: переименуйте экспортированный тип `PaneOptions` в `Selection`
* Удалите поле `Lang` в типе данных `Style`
* Измените коэффициент преобразования точки в пиксели по умолчанию, связанная проблема [#279](https://github.com/xuri/excelize/issues/279) и [#1536](https://github.com/xuri/excelize/issues/1536)

### Примечательные особенности

* Добавить новую экспортированную переменную ошибки `ErrExistsTableName`
* Добавьте новые параметры `ShortDatePattern`, `LongDatePattern`, `LongTimePattern` и `CultureInfo` в типе данных `Options`, связанная проблема [#1199](https://github.com/xuri/excelize/issues/1199)
* Добавить новое перечисление типа экспортируемых данных `CultureName` для кода страны
* Поддержка заполнителя, заполнения, округления чисел, строки валюты и аргумента переключения по указанному коду числового формата, связанная проблема [#660](https://github.com/xuri/excelize/issues/660)
* Добавить сведения об ограничении длины пути к файлу в сообщении об ошибке
* New function `GetPanes` support to get sheet panes and view selection
* Функция `AddChart` поддерживает установку основных заголовков, связанная проблема [#1553](https://github.com/xuri/excelize/issues/1553)

### Улучшение совместимости

* Поддержка проверки длины значения ячейки с многобайтовыми символами, связанная проблема [#1517](https://github.com/xuri/excelize/issues/1517)
* Запретить создание повторяющихся таблиц и определенного имени с тем же именем
* Улучшена совместимость размеров поля комментариев к ячейкам с KingSoft WPS
* Поддержка возврата к ширине столбца по умолчанию в свойстве формата листа, связанная проблема [#1536](https://github.com/xuri/excelize/issues/1536)

### Исправление ошибок

* Escape-символы XML после проверки длины значения ячейки, исправить поврежденный файл, сгенерированный потоковым писателем, связанная проблема [#1518](https://github.com/xuri/excelize/issues/1518), [#1519](https://github.com/xuri/excelize/issues/1519) и [#1530](https://github.com/xuri/excelize/issues/1530)
* Исправьте неправильный размер окна комментария для многострочных комментариев в виде простого текста
* Предотвращение форматирования текстового значения ячейки как числового, связанная проблема [#1523](https://github.com/xuri/excelize/issues/1523), [#1528](https://github.com/xuri/excelize/issues/1528) и [#1533](https://github.com/xuri/excelize/issues/1533)
* Исправление условий гонки для функций безопасности параллелизма
* Исправьте неправильную круглую миллисекунду для даты и времени
* Исправить неверный формат числа для даты и времени с 12 часами в AM
* Исправить ожидаемый результат исключения вычисления неправильной формулы
* Исправлена проблема со ссылками на листы для механизма расчета формул
* Исправить проблему настройки таблицы после удаления строк, связанная проблема [#1539](https://github.com/xuri/excelize/issues/1539)
* Поддержка получения нескольких изображений в одной ячейке, связанная проблема [#1548](https://github.com/xuri/excelize/issues/1548)
* Исправлен неправильный номер строки при получении позиции объекта, связанная проблема [#1560](https://github.com/xuri/excelize/issues/1560)

### Оптимизация производительности

* Оптимизация вызовов регулярных выражений для повышения производительности, связанная проблема [#1532](https://github.com/xuri/excelize/issues/1532)
* Это позволяет избежать ненужного преобразования байт/строка, связанная проблема [#1541](https://github.com/xuri/excelize/issues/1541)

### Другие

* Обновлен модуль зависимостей
* Упрощение объявления переменных и операторов возврата ошибок
* Удалите встроенное сопоставление кода формата номера языка со значениями Unicode
* Удалите внутренний тип данных `xlsxTabColor`, используя тип данных `xlsxColor` вместо `xlsxTabColor`
* Унитарные тесты и godoc обновлены
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен

### Спасибо

Спасибо всем участникам Excelize. Ниже приведен список участников, внесших свой код в эту версию:

* @IAkumaI (Valery Ozarnichuk)
* @sillydong (Chen Zhidong)
* @fudali113 (fudali)
* @Juneezee (Eng Zer Jun)
* @joehan109
* @yicixin (壹次心)
* @vb6iscool
* @chengcxy (chengxinyao)
