# Excelize v2.8.0

* Версия выпущена: 28 Август 2023 г.
* Выпуск GitHub: [https://github.com/xuri/excelize/releases/tag/v2.8.0](https://github.com/xuri/excelize/releases/tag/v2.8.0)

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Переименуйте экспортированную переменную `ErrTableNameLength` в `ErrNameLength`
* Переименуйте экспортированный тип `PaneOptions` в `Selection`
* Переименуйте поле `Runs` в `Paragraph` в экспортированном типе данных `Comment`
* Удалите поле `Lang` в типе данных `Style`
* Удален экспортированный тип данных `ChartTitle` и использование вместо него типа данных `RichTextRun`
* Изменен тип данных для `DecimalPlaces` на указатель целого числа
* Измените коэффициент преобразования точки в пиксели по умолчанию, связанная проблема [#279](https://github.com/xuri/excelize/issues/279) и [#1536](https://github.com/xuri/excelize/issues/1536)
* Измените сигнатуру функции `AddShape`: `func (f *File) AddShape(sheet, cell string, opts *Shape) error` на `func (f *File) AddShape(sheet string, opts *Shape) error`

### Примечательные особенности

* Добавьте новые экспортированные переменные ошибок `ErrExistsTableName` и `ErrorFormControlValue`
* Добавьте новые параметры `ShortDatePattern`, `LongDatePattern`, `LongTimePattern` и `CultureInfo` в типе данных `Options`, связанная проблема [#1199](https://github.com/xuri/excelize/issues/1199)
* Добавить новое перечисление типа экспортируемых данных `CultureName` для кода страны
* Новые функции GetTables и DeleteTable поддерживают получение и удаление таблиц, связанная проблема [#674](https://github.com/xuri/excelize/issues/674) и [#1454](https://github.com/xuri/excelize/issues/1454)
* Поддержка новой функции `GetStyle` для получения определений стилей, связанная проблема [#314](https://github.com/xuri/excelize/issues/314), [#1520](https://github.com/xuri/excelize/issues/1520) и [#1521](https://github.com/xuri/excelize/issues/1521)
* Поддержка применения значения ячейки с заполнителем, отступами, числами раундов, валютой, бухгалтерским учетом и переключателем формата номера аргумента, а также поддержка применения формата даты и времени для языковых тегов 812, связанная проблема [#660](https://github.com/xuri/excelize/issues/660)
* Новые функции поддержки 10 формул: ARRAYTOTEXT, FORECAST, FORECAST.LINEAR, FREQUENCY, INTERCEPT, ODDFYIELD, ODDLPRICE, ODDLYIELD, PROB, VALUETOTEXT
* Добавить сведения об ограничении длины пути к файлу в сообщении об ошибке
* Поддержка новой функции `GetPanes` для получения панелей листа и выбора просмотра.
* Новые функции `AddFormControl`, `GetFormControls` и `DeleteFormControl` поддерживают элементы управления формы, связанная проблема [#301](https://github.com/xuri/excelize/issues/301) и [#1169](https://github.com/xuri/excelize/issues/1169)
* Функция `AddChart` поддерживает установку основных заголовков, связанная проблема [#1553](https://github.com/xuri/excelize/issues/1553)
* Функция `AddChart` поддерживает создание диаграммы с осью вторичного ряда, связанная проблема [#518](https://github.com/xuri/excelize/issues/518)
* Функция `AddChart` поддерживает форматирование и установку форматированных текстовых заголовков для диаграммы, связанная проблема [#1588](https://github.com/xuri/excelize/issues/1588)
* Добавлена проверка типа фигуры для функции `AddShape`, будет возвращена ошибка, если тип фигуры не указан
* Поддержка чтения значений ячеек, отформатированных в формате чисел японского календаря, связанная проблема [#1590](https://github.com/xuri/excelize/issues/1590)
* Функция `GetPictures` поддерживает чтение изображений привязки одной ячейки, связанная проблема [#1585](https://github.com/xuri/excelize/issues/1585)
* Функция NewConditionalStyle поддерживает создание условного формата с числовым форматом и защитой, связанная проблема [#1610](https://github.com/xuri/excelize/issues/1610)

### Улучшение совместимости

* Поддержка проверки длины значения ячейки с многобайтовыми символами, связанная проблема [#1517](https://github.com/xuri/excelize/issues/1517)
* Запретить создание повторяющихся таблиц и определенного имени с тем же именем
* Улучшена совместимость размеров поля комментариев к ячейкам с KingSoft WPS
* Поддержка возврата к ширине столбца по умолчанию в свойстве формата листа, связанная проблема [#1536](https://github.com/xuri/excelize/issues/1536)
* Сделано без учета регистра для внутреннего XML-пути рабочего листа для улучшения совместимости, связанная проблема [#1591](https://github.com/xuri/excelize/issues/1591)

### Исправление ошибок

* Escape-символы XML после проверки длины значения ячейки, исправить поврежденный файл, сгенерированный потоковым писателем, связанная проблема [#1518](https://github.com/xuri/excelize/issues/1518), [#1519](https://github.com/xuri/excelize/issues/1519) и [#1530](https://github.com/xuri/excelize/issues/1530)
* Исправьте неправильный размер окна комментария для многострочных комментариев в виде простого текста
* Предотвращение форматирования текстового значения ячейки как числового, связанная проблема [#1523](https://github.com/xuri/excelize/issues/1523), [#1528](https://github.com/xuri/excelize/issues/1528) и [#1533](https://github.com/xuri/excelize/issues/1533)
* Исправление условий гонки для функций безопасности параллелизма
* Исправьте неправильную круглую миллисекунду для даты и времени
* Исправить неверный формат числа для даты и времени с 12 часами в AM
* Исправьте неверные функции формулы SUMIFS и AVERAGEIFS, связанная проблема [#1564](https://github.com/xuri/excelize/issues/1564)
* Исправление основных проблем с приоритетом арифметических операций в вычислительном движке, связанная проблема [#1599](https://github.com/xuri/excelize/issues/1599)
* Исправлена проблема со ссылками на листы для механизма расчета формул
* Исправить проблему настройки таблицы после удаления строк, связанная проблема [#1539](https://github.com/xuri/excelize/issues/1539)
* Поддержка получения нескольких изображений в одной ячейке, связанная проблема [#1548](https://github.com/xuri/excelize/issues/1548)
* Исправлена ошибка, из-за которой положение добавленного изображения было неправильным в некоторых случаях, связанная проблема [#1560](https://github.com/xuri/excelize/issues/1560)
* Поддержка настройки формулы при вставке столбцов и строк, исправление повреждения книги, вызванного вставкой столбцов или строк, вызванных, связанная проблема [#1565](https://github.com/xuri/excelize/issues/1565)
* Функция формулы CONCAT, CONCATENATE поддерживает объединение нескольких значений ячеек, связанная проблема [#1569](https://github.com/xuri/excelize/issues/1569)
* Исправлена неправильная формула, вычисляющая результаты для вложенной функции аргумента, которая возвращает числовой результат, связанная проблема [#1582](https://github.com/xuri/excelize/issues/1582)
* Исправление внутренних проблем со счетчиком графических объектов, из-за которых добавленное изображение дублировалось, связанная проблема [#1584](https://github.com/xuri/excelize/issues/1584)
* Исправлена ошибка, из-за которой результат чтения ячейки даты и времени был неправильно вызван проблемой округления часов, связанная проблема [#1587](https://github.com/xuri/excelize/issues/1587)
* Исправлена паника при получении объединенных ячеек с одной и той же начальной и конечной осями

### Оптимизация производительности

* Оптимизация вызовов регулярных выражений для повышения производительности, связанная проблема [#1532](https://github.com/xuri/excelize/issues/1532)
* Это позволяет избежать ненужного преобразования байт/строка, связанная проблема [#1541](https://github.com/xuri/excelize/issues/1541)

### Другие

* Обновлен модуль зависимостей
* Упрощение объявления переменных и операторов возврата ошибок
* Удалите встроенное сопоставление кода формата номера языка со значениями Unicode
* Удалите внутренний тип данных `xlsxTabColor`, используя тип данных `xlsxColor` вместо `xlsxTabColor`
* Унитарные тесты и godoc обновлены
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен

### Спасибо

Спасибо всем участникам Excelize. Ниже приведен список участников, внесших свой код в эту версию:

* @IAkumaI (Valery Ozarnichuk)
* @sillydong (Chen Zhidong)
* @fudali113 (fudali)
* @Juneezee (Eng Zer Jun)
* @joehan109
* @yicixin (壹次心)
* @vb6iscool
* @chengcxy (chengxinyao)
* @lidp20
* @JDavidVR (David)
* @fsfsx
* @cnmlgbgithub
