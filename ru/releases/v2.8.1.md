# Excelize v2.8.1

* Выйдет: 2024

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Требования к обновлению Языковая версия Go 1.18 или новее, для обновления пакета зависимостей `golang.org/x/net`
* Измените тип данных для полей структуры `HeaderFooterOptions` `AlignWithMargins` и `ScaleWithDoc` в качестве указателя, связанная проблема [#1645](https://github.com/xuri/excelize/issues/1645)
* Удалить неиспользуемую экспортированную структуру данных `ShapeColor`

### Примечательные особенности

* Добавлена новая экспортируемая функция `SetCellUint`, связанная проблема [#1681](https://github.com/xuri/excelize/issues/1681)
* Добавлена новая экспортируемая функция `GetPictureCells` для получения всех ячеек изображения, связанная проблема [#1218](https://github.com/xuri/excelize/issues/1218)
* Добавлена новая экспортируемая функция `GetConditionalStyle` для получения определения стиля условного формата, связанная проблема [#1690](https://github.com/xuri/excelize/issues/1690)
* Добавлена новая экспортируемая функция `GetHeaderFooter` для получения верхнего и нижнего колонтитулов листа
* Добавлена новая экспортируемая функция `AddSlicer` для добавления срезов таблиц и сводных таблиц
* Добавлена новая экспортируемая функция `GetPivotTables` для получения сводных таблиц
* Добавлена новая экспортируемая функция `DeletePivotTable` для удаления сводной таблицы
* Добавьте новое поле `Name` в `PivotTableOptions` для поддержки указания имени сводной таблицы
* Новые функции поддержки 5 формул: SEARCH, SEARCHB, TEXT, TEXTAFTER и TEXTBEFORE
* Добавлено перечисление export 'ChartLineType' для указания типа линии графика, связанная проблема [#1706](https://github.com/xuri/excelize/issues/1706)
* Добавлено новое поле `Border` в типе данных `Chart`, чтобы задать границу области графика
* Добавьте новое поле `Type` в тип `ChartLine`, чтобы задать тип линии
* Добавление новых экспортированных исходных отношений и пространств имен `NameSpaceSpreadSheetXR10`, `ContentTypeSlicer`, `ContentTypeSlicerCache` и `SourceRelationshipSlicer`
* Добавление нового экспортированного расширенного URI `ExtURIPivotCacheDefinition`
* Разрешить символ точки в определенном имени, имени таблицы или имени сводной таблицы
* Сохранять все значения ячеек в диапазоне таблицы при удалении таблицы
* Поддержка формата значения ячейки с кодом формата дробного числа
* Поддержка внутреннего удаления файлов изображений из книги при удалении изображений, чтобы уменьшить размер создаваемой книги и устранить потенциальные проблемы безопасности
* Поддержка установки высоты и ширины поля комментария, связанная проблема [#1688](https://github.com/xuri/excelize/issues/1688)
* Поддержка условного форматирования обновлений, проверки данных, определенных имен, объектов чертежа, ссылок на формулы и изменяемых зависимостей при вставке/удалении столбцов и строк, связанная проблема [#1306](https://github.com/xuri/excelize/issues/1306) и [#1615](https://github.com/xuri/excelize/issues/1615)
* Поддержка 6 новых типов условного форматирования: текст, пробелы, без пробелов, ошибки, без ошибок и период времени
* Поддержка формулы вычисления с несколькими арифметическими символами тире
* Поддержка условного формата копирования и проверки данных в повторяющейся строке, связанная проблема [#1729](https://github.com/xuri/excelize/issues/1729)
* Поддержка отмены пользовательской высоты строки, если значение высоты равно -1 при использовании функции `SetRowHeight`
* Функция `SetRowHeight` вернет ошибку, если задано неверное значение высоты строки
* Поддержка функции `AddChart` устанавливает положение меток данных для диаграммы, связанная проблема [#1704](https://github.com/xuri/excelize/issues/1704)
* Добавлено новое поле `DataLabelPosition` в тип данных `ChartSeries`, поддержка установки положения метки данных серии диаграммы
* Добавьте новое поле `BubbleSize` в тип данных `Chart`, поддержка установки размера пузырька во всех рядах данных для пузырьковой диаграммы или пузырьковой трехмерной диаграммы
* Добавлен новый тип данных экспорта `ChartDataLabelPositionType`
* Поддержка функций `GetPictureCells` и `GetPictures` позволяет получать встроенные изображения ячеек, созданные Kingsoft WPS&trade; Office, связанная проблема [#664](https://github.com/xuri/excelize/issues/664)

### Улучшение совместимости

* Улучшена совместимость деталей с абсолютной траекторией
* Улучшена совместимость значения свойства внутреннего соотношения табуляции книги
* Улучшена совместимость с пустым кодом пользовательского числового формата
* Улучшена совместимость с средством просмотра, которое не поддерживает пространство имен частей темы по умолчанию, связанная проблема [#1694](https://github.com/xuri/excelize/issues/1694)
* Сохранение книги с отсортированным внутренним путем к частям, сделайте так, чтобы хеш-сумма созданных одинаково созданных книг была одинаковой, связанная проблема [#1732](https://github.com/xuri/excelize/issues/1732)

### Исправление ошибок

* Добавлена проверка функций MID и формул MIDB num_chars аргументов, предотвращена паника при указании отрицательного числа, связанная проблема [#1647](https://github.com/xuri/excelize/issues/1647)
* Исправление пустого результата вычисления с числовыми аргументами в функциях формул LEN, LOWER, PROPER, REPT, UPPER и IF
* Исправлена паника вычисления формул CHITEST и MMULT в некоторых случаях
* Исправлена ошибка регрессии версии 2.8.0, ошибка при задании области печати и печати заголовков со встроенным специальным определенным именем
* Исправлена ошибка регрессии версии 2.8.0, из-за которой были повреждены книги, созданные путем улучшения совместимости с внутренне индексированными частями стилей цветов и цветов MRU.
* Исправлена ошибка регрессии v2.8.0, результат применения кода числового формата был пустым, связанная проблема [#1658](https://github.com/xuri/excelize/issues/1658)
* Исправлена ошибка регрессии v2.7.1, пузырь скрыт в пузырьковой или трехмерной пузырьковой диаграмме
* Исправлена паника при `AutoFilter` путем добавления nil pointer guard для локального идентификатора листа, связанная проблема [#1655](https://github.com/xuri/excelize/issues/1655)
* Исправление поврежденных книг, созданных при добавлении таблиц в некоторых случаях
* Исправление неправильного результата формата числа времени, связанная проблема [#1661](https://github.com/xuri/excelize/issues/1661)
* Поддерживает получение значения ячейки строки формулы, связанная проблема [#1665](https://github.com/xuri/excelize/issues/1665)
* Исправление неверного идентификатора таблицы, созданного в книге, содержащей отдельные ячейки таблицы
* Исправление отсутствующих частей отношений в типах содержимого в некоторых случаях
* Обновление средства синтаксического анализа числового формата для исправления отсутствующих литеральных маркеров в некоторых случаях
* Обновление встроенного формата номеров языка zh-cn и zh-tw
* Исправление неверного выделенного идентификатора пользовательского числового формата, связанная проблема [#1677](https://github.com/xuri/excelize/issues/1677)
* Исправлена ошибка, из-за которой обновление диапазона таблицы путем ее удаления и создания снова не работало, связанная проблема [#1682](https://github.com/xuri/excelize/issues/1682)
* Устранена потенциальная проблема, из-за которой временные файлы средства чтения потоков могут быть нечеткими, связанная проблема [#1680](https://github.com/xuri/excelize/issues/1680)
* Исправлен неверный результат вычисления формулы в некоторых случаях, связанная проблема [#1681](https://github.com/xuri/excelize/issues/1681)
* Исправление условий гонки параллелизма при получении значения ячейки, связанная проблема [#1687](https://github.com/xuri/excelize/issues/1687)
* Исправление некоторого отсутствующего формата при получении определения стиля, связанная проблема [#1708](https://github.com/xuri/excelize/issues/1708)
* Исправление проблем с экспоненциальным заполнением нулевого формата числового формата, связанная проблема [#1710](https://github.com/xuri/excelize/issues/1710)
* Исправлена паника при чтении книги с внутренним элементом строки без атрибута `r`, связанная проблема [#1723](https://github.com/xuri/excelize/issues/1723)
* Исправлена ошибка `GetCellRichText` при получении встроенных ячеек форматированного текста
* Исправление недопустимого индекса общей строковой таблицы при задании значения ячейки в некоторых случаях
* Исправлена паника `GetConditionalFormats` при получении условного формата без правил выше среднего, связанная проблема [#1745](https://github.com/xuri/excelize/issues/1745)
* Исправить неправильную настройку объединенных ячеек при удалении строк, связанная проблема [#1749](https://github.com/xuri/excelize/issues/1749)
* Исправлена ошибка, из-за которой функция `SetConditionalFormat` создавала неправильный приоритет правил для нескольких условных форматов, связанная проблема [#1770](https://github.com/xuri/excelize/issues/1770)
* Исправлена ошибка, из-за которой функция `GetConditionalFormats` не возвращала правило панели данных градиента, связанная проблема [#1769](https://github.com/xuri/excelize/issues/1769)
* Исправлена ошибка, из-за которой функция `GetStyle` или `GetConditionalStyle` возвращала неправильное значение поля `DecimalPlaces`, связанная проблема [#1777](https://github.com/xuri/excelize/issues/1777)

### Оптимизация производительности

* Повышена производительность при добавлении и удалении сводных таблиц и изображений.
* Уменьшите потребление памяти за счет обрезки строк и ячеек, связанная проблема [#1712](https://github.com/xuri/excelize/issues/1712)

### Другие

* Обновлен модуль зависимостей
* Унитарные тесты и godoc обновлены
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен

### Спасибо

Спасибо всем участникам Excelize. Ниже приведен список участников, внесших свой код в эту версию:

* @fnickels (Francis Nickels III)
* @m12r (Matthias Endler)
* @Abdelaziz-Ouhammou
* @Juneezee (Eng Zer Jun)
* @yicixin (壹次心)
* @TeeRenJing (rjtee)
* @phperic (magicrabbit)
* @kjushka (Anton Petrov)
* @krstak (Marko Krstic)
* @lpxxn (Nick)
* @ByteFlyCoding
* @yangliyl (Yang Li)
* @15535382838
* @TajangSec (Tajang)
* @lujin1 (lujin)
* @parkoo (Tian)
* @ZhangXiao1024 (ZX)
* @zcgly
* @bramvbilsen (Bram Vanbilsen)
* @user65536
* @tianaiyouqing (天爱有情)
* @cuishuang (cui fliter)
* @CooolNv (Xuesong)
* @yuegu520
* @oneweek20169902 (li)
