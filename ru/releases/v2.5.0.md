# Excelize v2.5.0

* Версия выпущена: 3 Январь 2022 г.
* Выпуск GitHub: [https://github.com/xuri/excelize/releases/tag/v2.5.0](https://github.com/xuri/excelize/releases/tag/v2.5.0)

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Требуется закрыть электронную таблицу и итератор строки, пользователь должен закрыть поток после использования итератора строки и закрыть электронную таблицу после открытия существующей электронной таблицы
* Измените `ReadZipReader` как реализацию `File`, извлеките электронную таблицу с заданными параметрами и поддержите извлечение в памяти или касание файловой системы
* Удалите ненужную экспортируемую переменную `XMLHeader`, мы можем использовать вместо нее файл `xml.Header` из пакета `encoding/xml`
* Удалите неиспользуемую экспортированную переменную ошибки `ErrToExcelTime`

### Примечательные особенности

* Новый API: поддержка `SetRowStyle` для заданного стиля для строк, связанная проблема [#990](https://github.com/xuri/excelize/issues/990)
* Новый API: поддержка `GetCellType` для получения типа данных ячейки, связанная проблема [#417](https://github.com/xuri/excelize/issues/417) и [#520](https://github.com/xuri/excelize/issues/520)
* Новый API: поддержка `SetAppProps` и `GetAppProps` для установки и получения свойств приложения документа, связанная проблема [#1095](https://github.com/xuri/excelize/issues/1095)
* `GetCellValue`, `GetRows`, `GetCols`, `Rows` и `Cols` поддерживают указание читаемой ячейки с необработанным значением, связанная проблема [#621](https://github.com/xuri/excelize/issues/621)
* Новая поддержка 95 функций формул: ACCRINT, ACCRINTM, ADDRESS, AMORDEGRC, AMORLINC, AVEDEV, AVERAGEIF, CHIDIST, CONFIDENCE, CONFIDENCE.NORM, COUNTIF, COUNTIFS, COUPDAYBS, COUPDAYS, COUPDAYSNC, COUPNCD, COUPNUM, COUPPCD, DATEVALUE, DAY, DAYS, DELTA, DEVSQ, DISC, DURATION, ERF, ERF.PRECISE, ERFC, ERFC.PRECISE, GEOMEAN, GESTEP, IFNA, IFS, INDEX, INTRATE, ISFORMULA, ISLOGICAL, ISREF, ISOWEEKNUM, MATCH, MAXA, MAXIFS, MDURATION, MINIFS, MINUTE, MONTH, ODDFPRICE, PERCENTILE.EXC, PERCENTRANK.EXC, PERCENTRANK.INC, PERCENTRANK, PRICE, PRICEDISC, PRICEMAT, PV, QUARTILE.EXC, RANK, RANK.EQ, RATE, RECEIVED, RRI, SHEETS, SLN, STANDARDIZE, STDEV.P, STDEVP, SWITCH, SYD, TBILLEQ, TBILLPRICE, TBILLYIELD, TEXTJOIN, TIME, TRANSPOSE, TRIMMEAN, VALUE, VAR, VAR.S, VARA, VARPA, VDB, WEEKDAY, WEIBULL, WEIBULL.DIST, XIRR, XLOOKUP, XNPV, XOR, YEAR, YEARFRAC, YIELD, YIELDDISC, YIELDMAT, Z.TEST, ZTEST, связанная проблема [#1002](https://github.com/xuri/excelize/issues/1002)
* Механизм вычисления формул поддерживает вложенные вычисления для формулы `IF`, связанная проблема [#987](https://github.com/xuri/excelize/issues/987)
* Поддержка механизма вычисления формул получить общую формулу, связанная проблема [#844](https://github.com/xuri/excelize/issues/844)
* Сравнение текста поддержки механизма вычисления формул, связанная проблема [#998](https://github.com/xuri/excelize/issues/998)
* Поддержка указать формулу в диапазоне проверки данных, связанная проблема [#1012](https://github.com/xuri/excelize/issues/1012)
* Поддержка указанного ограничения размера распаковки для параметров открытого файла, предотвращение атак на уязвимость с помощью zip-бомб
* SetCellFormula теперь поддерживает установку общей формулы
* UpdateLinkedValue пропустит лист макросов, связанная проблема [#1014](https://github.com/xuri/excelize/issues/1014)
* Исправить `AddPicture`, создававшее дублирующееся изображение в некоторых случаях, вызванное неправильным вычислением идентификатора внутренних отношений, связанная проблема [#1017](https://github.com/xuri/excelize/issues/1017)
* `AddShape` поддерживает установку ширины линии для добавления фигуры, связанная проблема [#262](https://github.com/xuri/excelize/issues/262)
* Добавлены новые параметры `UnzipXMLSizeLimit`, поддержка указывает лимит памяти при распаковке рабочего листа и таблицы общих строк в байтах
* Будет возвращена ошибка, если при создании нового стиля указан недопустимый пользовательский числовой формат, связанная проблема [#1028](https://github.com/xuri/excelize/issues/1028)
* Теперь поддерживается установка стиля строки в потоковом писателе
* Модуль записи потоков создаст формат числа времени для ячеек типа времени, связанная проблема [#1107](https://github.com/xuri/excelize/issues/1107)
* Теперь поддерживается указание компактности и структуры для сводной таблицы, связанная проблема [#1029](https://github.com/xuri/excelize/issues/1029)
* Поддержка получения текущих строк / столбцов и общего количества строк / столбцов в средстве чтения потока, связанная проблема [#1054](https://github.com/xuri/excelize/issues/1054)
* Теперь поддержка местоположения часового пояса при установке значения ячейки, связанная проблема [#1069](https://github.com/xuri/excelize/issues/1069)
* Экспортируйте 7 ошибок, чтобы пользователи могли по-разному реагировать на разные типы ошибок

### Улучшение совместимости

* Улучшена совместимость с элементом строки с атрибутом `r="0"`
* Сохранить управляющий символ XML
* Улучшение совместимости настроек стиля с Apple Numbers, связанная проблема [#1059](https://github.com/xuri/excelize/issues/1059)
* Поддержка многобайтового языка в заданном нижнем колонтитуле верхнего колонтитула, связанная проблема [#1061](https://github.com/xuri/excelize/issues/1061)
* Сохранять символ горизонтальной табуляции при установке значения ячейки, связанная проблема [#1108](https://github.com/xuri/excelize/issues/1108)

### Исправление ошибок

* Исправить ошибку при удалении проверки данных, решенная проблема [#979](https://github.com/xuri/excelize/issues/979)
* В некоторых случаях сбой в раскрывающемся списке проверки данных набора исправлений, решенная проблема [#986](https://github.com/xuri/excelize/issues/986)
* Механизм вычисления исправления формул `LOOKUP` некорректно обрабатывает форму массива, решенная проблема [#994](https://github.com/xuri/excelize/issues/994)
* Механизм вычисления исправлений формул `LOOKUP` может найти только точное совпадение, решенная проблема [#997](https://github.com/xuri/excelize/issues/997)
* Исправить неправильно рассчитанные процентные значения формулы, решенная проблема [#993](https://github.com/xuri/excelize/issues/993)
* Исправить панику, вызванную неправильным чтением ячейки в некоторых случаях
* Исправить условный формат нижней части N не работает
* Устранить проблему точности синтаксического анализа времени, решенная проблема [#1026](https://github.com/xuri/excelize/issues/1026) и [#1030](https://github.com/xuri/excelize/issues/1030)
* Не удалось исправить встроенный формат научных чисел, решенная проблема [#1027](https://github.com/xuri/excelize/issues/1027)
* Исправить небольшую ошибку синтаксического анализа с плавающей запятой в некоторых случаях, решенная проблема [#1031](https://github.com/xuri/excelize/issues/1031)
* Исправить ошибку удаления рабочего листа в некоторых случаях
* Исправить ошибку синтаксического анализа встроенного формата времени, решенная проблема [#1060](https://github.com/xuri/excelize/issues/1060)
* Исправить `NewStyle` в некоторых случаях возвращал неверный идентификатор стиля
* Исправить ошибку объединенного диапазона ячеек после вставки / удаления строки / столбца в некоторых угловых случаях

### Оптимизация производительности

* Ускорение затрат времени на слияние ячеек на основе снижения затрат времени на ранее выпущенную версию более чем на 90%
* Улучшить производительность потокового чтения, разархивировать таблицу общих строк во временный системный файл, когда большой внутренний XML, на основе ранее выпущенной версии, использование памяти уменьшилось примерно на 60% максимум, связанная проблема [#1096](https://github.com/xuri/excelize/issues/1096)
* Ускорение чтения списка рабочих листов
* Объедините стили столбцов, чтобы уменьшить размер таблицы, решенная проблема [#1057](https://github.com/xuri/excelize/issues/1057)

### Другие

* Обновлен модуль зависимостей
* Унитарные тесты и godoc обновлены
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен

### Спасибо

Спасибо всем участникам Excelize. Ниже приведен список участников, внесших свой код в эту версию:

* @bailantaotao (bailantaotao)
* @threeq (Conrad Dally)
* @raochq (raochangquan)
* @stanim (Stani)
* @tvso (Tammy)
* @Jerring
* @seanliang (Sean Liang)
* @oneweek20169902 (li)
* @mwiesenbauer (Michael Wiesenbauer)
* @Dokiys (Dokiy)
* jaby
* @vst93 (vst)
