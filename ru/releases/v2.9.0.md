# Excelize v2.9.0

* Выйдет: 2024

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Измените тип данных для поля структуры `ConditionalFormatOptions` `Format` как указатель, связанная проблема [#1867](https://github.com/xuri/excelize/issues/1867)

### Примечательные особенности

* Добавить новые функции `DeleteSlicer` и `GetSlicers`, связанная проблема [#810](https://github.com/xuri/excelize/issues/810)
* Добавить новую функцию `MoveSheet` для поддержки изменения порядка листов в рабочей книге, связанная проблема [#1076](https://github.com/xuri/excelize/issues/1076)
* Добавлено новое поле `AutoFitIgnoreAspect` в поддержку типа данных `GraphicOptions` для заполнения ячейки изображением и игнорирования его соотношения сторон
* Добавлено новое поле `TickLabelPosition` в поддержку типа данных `ChartAxis` для установки положения метки диаграммы
* Добавить новые поля `ShowAll`, `InsertBlankRow` и поле `NumFmt` в тип данных `PivotTableField`
* Добавить новые поля `ClassicLayout`, `FieldPrintTitles` и `ItemPrintTitles` в тип данных `PivotTableOptions`
* Введены 2 новых экспортируемых типа перечисления `ChartTickLabelPositionType` и `PictureInsertType`
* Введено новое экспортируемое значение перечисления `ChartLineUnset`
* Ввести 4 константы `ExtURIDataField`, `ExtURIPivotField`, `ExtURIPivotFilter` и `ExtURIPivotHierarchy`
* Введена новая экспортируемая переменная ошибки `ErrPivotTableClassicLayout`
* Функция `MergeCell` поддерживает очистку значения подчиненных ячеек при объединении ячеек.
* Функции `AddDataValidation`, `DeleteDataValidation` и `GetCellStyle` поддерживают безопасный параллельный доступ, связанная проблема [#1825](https://github.com/xuri/excelize/issues/1825) и [#1903](https://github.com/xuri/excelize/issues/1903)
* Функция `GetDataValidations` поддерживает получение проверок данных, которые сохраняются в списках расширений, связанная проблема [#1835](https://github.com/xuri/excelize/issues/1835)
* Функция `SetSheetName` поддерживает чувствительность к регистру, связанная проблема [#1856](https://github.com/xuri/excelize/issues/1856)
* Функции `GetPictureCells` и `GetPictures` поддерживают получение изображений ячеек, вставленных с помощью функции формулы IMAGE, и абсолютных путей для изображений
* Добавьте новое поле `AutoFitIgnoreAspect` в поддержку типа данных `GraphicOptions`, чтобы заполнить ячейку изображением и игнорировать его соотношение сторон
* Функция `SetCellHyperLink` поддерживает удаление гиперссылки по типу ссылки `None`, связанная проблема [#1940](https://github.com/xuri/excelize/issues/1940)
* Функция `AddChart` поддерживает создание комбинированных диаграмм с теми же типами, связанная проблема [#1940](https://github.com/xuri/excelize/issues/1940)
* Функция `AddChart` поддерживает установку типа линии точечной диаграммы
* Если при создании сводной таблицы функцией `AddPivotTable` ячейка заголовка столбца пуста в диапазоне данных сводной таблицы, будет возвращена ошибка, связанная проблема [#1945](https://github.com/xuri/excelize/issues/1945)
* Добавить поддержку применения выражений числового формата с тегами языка/местоположения и идентификатором
* Новая функция формулы поддержки: РУБЛЬ

### Улучшение совместимости

* Улучшение совместимости для применения формата номера, поддержка применения формата номера с выравниванием, связанная проблема [#1847](https://github.com/xuri/excelize/issues/1847)
* Улучшение совместимости внутренней части книги с префиксом пространства имен электронной таблицы, связанная проблема [#1886](https://github.com/xuri/excelize/issues/1886)
* Улучшена совместимость внутренних медиафайлов книги с абсолютным путем, связанная проблема [#1888](https://github.com/xuri/excelize/issues/1888)

### Исправление ошибок

* Исправлена ошибка регрессии v2.8.1, автоматический фильтр не работает в LibreOffice, связанная проблема [#1830](https://github.com/xuri/excelize/issues/1830)
* Исправлена ошибка регрессии v2.8.1, поддержка настройки проверки данных с использованием нескольких диапазонов ячеек, связанная проблема [#1831](https://github.com/xuri/excelize/issues/1831)
* Исправлена ошибка регрессии v2.8.1, ошибка в повторяющихся строках, если условное форматирование или проверка данных имеют ссылку на несколько диапазонов ячеек
* Исправлена ошибка регрессии v2.8.1, неправильное значение ячейки записано при сохранении несколько раз, связанная проблема [#1906](https://github.com/xuri/excelize/issues/1906)
* Исправлена ошибка регрессии v2.8.1, искровые линии дублируются при создании искровых линий на нескольких листах, связанная проблема [#1910](https://github.com/xuri/excelize/issues/1910)
* Функция `CalcCellValue` поддерживает расчет функций формулы ISNUMBER, OR и FIND с матричными аргументами, связанная проблема [#1819](https://github.com/xuri/excelize/issues/1819)
* Исправлена проблема с результатами расчета функции `CalcCellValue`, связанная проблема [#1851](https://github.com/xuri/excelize/issues/1851)
* Исправлена ошибка, из-за которой функция `CalcCellValue` возвращала неверный результат функций формулы XIRR и XNPV, связанная проблема [#1989](https://github.com/xuri/excelize/issues/1989)
* Исправлена ошибка возврата `RemoveCol` при удалении столбцов, связанная проблема [#1829](https://github.com/xuri/excelize/issues/1829)
* Исправить неправильный тип данных результата функции формулы DATE, связанная проблема [#1833](https://github.com/xuri/excelize/issues/1833)
* Исправлена паника при чтении книги с внутренним элементом строки без атрибута `r`
* Исправлена ошибка, из-за которой круглые скобки в формулах обрезались при вставке новых столбцов или строк, связанная проблема [#1861](https://github.com/xuri/excelize/issues/1861)
* Исправлен неверный результат escape-валидации данных в некоторых случаях
* Исправлена ошибка, из-за которой некоторые символы не отображались в потоке записи, связанная проблема [#1865](https://github.com/xuri/excelize/issues/1865)
* Сохранение книги с отсортированным внутренним путем к частям, чтобы сохранить одинаковый хэш идентичных файлов и исправить неправильный тип MIME, связанная проблема [#1889](https://github.com/xuri/excelize/issues/1889)
* Исправлен формат оси набора функции `AddChart`, который не работал в комбинированной диаграмме, связанная проблема [#1921](https://github.com/xuri/excelize/issues/1921)
* Исправлена ошибка, из-за которой функция `AddChart` устанавливала неправильное положение заголовков основных осей
* Исправлена ошибка, из-за которой заголовок функции `AddChart` не отображался на вторичной вертикальной оси, связанная проблема [#1926](https://github.com/xuri/excelize/issues/1926)
* Исправлена ошибка, из-за которой функция `AddChart` устанавливала тип линии линейной диаграммы, из-за чего она не работала
* Исправлена ошибка, из-за которой функция `GetPivotTables` возвращала неверный диапазон данных, связанная проблема [#1937](https://github.com/xuri/excelize/issues/1937)
* Исправлена ошибка функции `GetStyle`, когда тема не содержит `sysClr`, связанная проблема [#1963](https://github.com/xuri/excelize/issues/1963)
* Исправлена ошибка, из-за которой функция `GetCellRichText` возвращала ошибку при чтении ячейки без индекса SST, связанная проблема [#1999](https://github.com/xuri/excelize/issues/1999)
* Исправлена ошибка функции `SetSheetVisible` на листе без представлений, связанная проблема [#1969](https://github.com/xuri/excelize/issues/1969)
* Исправлено отсутствие знака процента в отформатированном результате для нулевого числового значения ячейки, связанная проблема [#1942](https://github.com/xuri/excelize/issues/1942)
* Исправлена отсутствующая горизонтальная ось в точечной диаграмме с отрицательными значениями
* Исправлена ошибка с отсутствующим макросом формы, отсутствующим после корректировки объекта рисования, связанная проблема [#1957](https://github.com/xuri/excelize/issues/1957)
* Исправлено отсутствие условного форматирования после удаления столбца в некоторых случаях, связанная проблема [#1968](https://github.com/xuri/excelize/issues/1968)
* Исправлена проблема округления десятичных значений при чтении значения ячейки, связанная проблема [#1979](https://github.com/xuri/excelize/issues/1979)
* Поддержка установки значения ячейки с помощью значения IEEE 754 "не число" или бесконечности, связанная проблема [#119](https://github.com/xuri/excelize/issues/119) и [#1955](https://github.com/xuri/excelize/issues/1955)

### Оптимизация производительности

* Исправлена регрессия скорости v2.8.0 и проблема с увеличением использования памяти
* Уменьшите использование памяти для функции `GetRows`, связанная проблема [#1874](https://github.com/xuri/excelize/issues/1874)
* Оптимизируйте производительность функции `ColumnNumberToName`, сократите использование памяти примерно на 50% и затраты времени на 50%

### Другие

* Обновлен модуль зависимостей
* Унитарные тесты и godoc обновлены
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен

### Спасибо

Спасибо всем участникам Excelize. Ниже приведен список участников, внесших свой код в эту версию:

* @mirgong (helloWorld)
* @YueChenXu-Kimi (岳晨旭)
* @JackMin1314 (陈王)
* @paolobarbolini (Paolo Barbolini)
* @iEvan-lhr (Evan lu)
* @yetyear (yeahyear)
* @ha5ky (hu5ky)
* @lizhichao (vic)
* @realzuojianxiang (realzuojianxiang)
* @msackman (Matthew Sackman)
* @yyle88 (yangyile-yyle88)
* @yunkeweb (yunkeweb)
* @iraj720 (Nima)
* @jianxinhou
* @barlevd
* @18409615759 (nna)
* @qijinkui (xiaokui)
* @user1121114685 (联盟少侠)
* @wangsongyan
* @vsemichev (Vovka Morkovka)
* @zhayt (Aybek)
* @ShowerBandV (ShowerBandV)
* @imink (Patrick Wang)
* @samkeke (wxy)
* @pjh591029530
* @zhangyimingdatiancai
* @wanghaochen2024
* @centurion-hub
* @peng (Zhang Zhipeng)
* @slashdotdash (Ben Smith)
* @ArcholSevier
* @liuwangchao
* @Zncl2222 (Jian Yu, Chen)
