# Excelize v2.9.0

* Выйдет: 2024

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Измените тип данных для поля структуры `ConditionalFormatOptions` `Format` как указатель, связанная проблема [#1867](https://github.com/xuri/excelize/issues/1867)

### Примечательные особенности

* Функция `MergeCell` поддерживает очистку значения подчиненных ячеек при объединении ячеек.
* Функции `AddDataValidation`, `DeleteDataValidation` и `GetCellStyle` поддерживают безопасный параллельный доступ, связанная проблема [#1825](https://github.com/xuri/excelize/issues/1825) и [#1903](https://github.com/xuri/excelize/issues/1903)
* Функция `GetDataValidations` поддерживает получение проверок данных, которые сохраняются в списках расширений, связанная проблема [#1835](https://github.com/xuri/excelize/issues/1835)
* Функция `SetSheetName` поддерживает чувствительность к регистру, связанная проблема [#1856](https://github.com/xuri/excelize/issues/1856)
* Функции `GetPictureCells` и `GetPictures` поддерживают получение изображений ячеек, вставленных с помощью функции формулы IMAGE
* Представлено новое экспортированное перечисление `PictureInsertType`
* Добавьте новое поле `AutoFitIgnoreAspect` в поддержку типа данных `GraphicOptions`, чтобы заполнить ячейку изображением и игнорировать его соотношение сторон
* Функция `SetCellHyperLink` поддерживает удаление гиперссылки по типу ссылки `None`, связанная проблема [#1940](https://github.com/xuri/excelize/issues/1940)

### Улучшение совместимости

* Улучшение совместимости для применения формата номера, поддержка применения формата номера с выравниванием, связанная проблема [#1847](https://github.com/xuri/excelize/issues/1847)
* Улучшение совместимости внутренней части книги с префиксом пространства имен электронной таблицы, связанная проблема [#1886](https://github.com/xuri/excelize/issues/1886)
* Улучшена совместимость внутренних медиафайлов книги с абсолютным путем, связанная проблема [#1888](https://github.com/xuri/excelize/issues/1888)

### Исправление ошибок

* Исправлена ошибка регрессии v2.8.1, автоматический фильтр не работает в LibreOffice, связанная проблема [#1830](https://github.com/xuri/excelize/issues/1830)
* Исправлена ошибка регрессии v2.8.1, поддержка настройки проверки данных с использованием нескольких диапазонов ячеек, связанная проблема [#1831](https://github.com/xuri/excelize/issues/1831)
* Исправлена ошибка регрессии v2.8.1, ошибка в повторяющихся строках, если условное форматирование или проверка данных имеют ссылку на несколько диапазонов ячеек
* Исправлена ошибка регрессии v2.8.1, неправильное значение ячейки записано при сохранении несколько раз, связанная проблема [#1906](https://github.com/xuri/excelize/issues/1906)
* Исправлена ошибка регрессии v2.8.1, искровые линии дублируются при создании искровых линий на нескольких листах, связанная проблема [#1910](https://github.com/xuri/excelize/issues/1910)
* Функция `CalcCellValue` поддерживает расчет функций формулы ISNUMBER, OR и FIND с матричными аргументами, связанная проблема [#1819](https://github.com/xuri/excelize/issues/1819)
* Исправлена проблема с результатами расчета функции `CalcCellValue`, связанная проблема [#1851](https://github.com/xuri/excelize/issues/1851)
* Исправлена ошибка возврата `RemoveCol` при удалении столбцов, связанная проблема [#1829](https://github.com/xuri/excelize/issues/1829)
* Исправить неправильный тип данных результата функции формулы DATE, связанная проблема [#1833](https://github.com/xuri/excelize/issues/1833)
* Исправлена паника при чтении книги с внутренним элементом строки без атрибута `r`
* Исправлена ошибка, из-за которой круглые скобки в формулах обрезались при вставке новых столбцов или строк, связанная проблема [#1861](https://github.com/xuri/excelize/issues/1861)
* Исправлен неверный результат escape-валидации данных в некоторых случаях
* Исправлена ошибка, из-за которой некоторые символы не отображались в потоке записи, связанная проблема [#1865](https://github.com/xuri/excelize/issues/1865)
* Сохранение книги с отсортированным внутренним путем к частям, чтобы сохранить одинаковый хэш идентичных файлов и исправить неправильный тип MIME, связанная проблема [#1889](https://github.com/xuri/excelize/issues/1889)
* Исправлен формат оси набора функции `AddChart`, который не работал в комбинированной диаграмме, связанная проблема [#1921](https://github.com/xuri/excelize/issues/1921)
* Исправлена ошибка, из-за которой функция `AddChart` устанавливала неправильное положение заголовков основных осей
* Исправлена ошибка, из-за которой заголовок функции `AddChart` не отображался на вторичной вертикальной оси, связанная проблема [#1926](https://github.com/xuri/excelize/issues/1926)

### Оптимизация производительности

* Исправлена регрессия скорости v2.8.0 и проблема с увеличением использования памяти
* Уменьшите использование памяти для функции `GetRows`, связанная проблема [#1874](https://github.com/xuri/excelize/issues/1874)
* Оптимизируйте производительность функции `ColumnNumberToName`, сократите использование памяти примерно на 50% и затраты времени на 50%

### Другие

* Обновлен модуль зависимостей
* Унитарные тесты и godoc обновлены
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен

### Спасибо

Спасибо всем участникам Excelize. Ниже приведен список участников, внесших свой код в эту версию:

* @mirgong (helloWorld)
* @YueChenXu-Kimi (岳晨旭)
* @JackMin1314 (陈王)
* @paolobarbolini (Paolo Barbolini)
* @iEvan-lhr (Evan lu)
* @yetyear (yeahyear)
* @ha5ky (hu5ky)
* @lizhichao (vic)
* @realzuojianxiang (realzuojianxiang)
* @msackman (Matthew Sackman)
* @yyle88 (yangyile-yyle88)
* @yunkeweb (yunkeweb)
* @iraj720 (Nima)
* @jianxinhou
* @barlevd
* @18409615759 (nna)
* @qijinkui (xiaokui)
* @user1121114685 (联盟少侠)
* @wangsongyan
* @vsemichev (Vovka Morkovka)
* @zhayt (Aybek)
* @ShowerBandV (ShowerBandV)
