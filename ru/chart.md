# Диаграмма

## Добавить диаграмму {#AddChart}

```go
func (f *File) AddChart(sheet, cell string, chart *ChartOptions, combo ...*ChartOptions) error
```

AddChart предоставляет метод добавления диаграммы на листе с помощью заданного набора формата диаграммы (например, смещение, масштаб, настройка соотношения сторон и параметры печати) и набор свойств.

Ниже показано `Type` диаграммы, поддерживаемый excelize:

Тип|Диаграмма
---|---
area                        | 2D диаграмма области
areaStacked                 | 2D диаграмма области с накоплением
areaPercentStacked          | 2D 100% диаграмма области с накоплением
area3D                      | 3D диаграмма области
area3DStacked               | 3D диаграмма области с накоплением
area3DPercentStacked        | 3D 100% диаграмма области с накоплением
bar                         | 2D кластерная гистограмма
barStacked                  | 2D Двухстрочная гистограмма
barPercentStacked           | 2D 100% сложная гистограмма
bar3DClustered              | 3D кластерная гистограмма
bar3DStacked                | 3D гистограмма
bar3DPercentStacked         | 3D 100% сложная гистограмма
bar3DConeClustered          | 3D конус кластерных диаграммы бар
bar3DConeStacked            | 3D конус штабелироваться диаграммы бар
bar3DConePercentStacked     | 3D 100% диаграмма конусной панели
bar3DPyramidClustered       | 3D пирамида кластерных диаграмма бара
bar3DPyramidStacked         | 3D пирамиды сложены диаграммы бар
bar3DPyramidPercentStacked  | 3D 100% пирамиды сложены диаграммы бар
bar3DCylinderClustered      | 3D цилиндровый кластерный бар диаграммы
bar3DCylinderStacked        | 3D цилиндр штабелироваться бар диаграммы
bar3DCylinderPercentStacked | 3D 100% цилиндр штабелироваться бар диаграммы
col                         | 2D группированная диаграмма столбцов
colStacked                  | 2D сложены диаграммы колонки
colPercentStacked           | 2D 100% сложены диаграммы колонки
col3D                       | 3D диаграмма столбца
col3DClustered              | 3D группированная диаграмма столбцов
col3DStacked                | 3D сложены диаграммы колонки
col3DPercentStacked         | 3D 100% сложены диаграммы колонки
col3DCone                   | 3D Диаграмма столбца конуса
col3DConeClustered          | 3D конус кластерных диаграмма столбца
col3DConeStacked            | 3D конус штабелироваться диаграммы колонки
col3DConePercentStacked     | 3D 100% конус штабелироваться диаграммы колонки
col3DPyramid                | 3D диаграмма столбца пирамиды
col3DPyramidClustered       | 3D пирамида кластерных диаграмма столбца
col3DPyramidStacked         | 3D пирамида сложены диаграммы колонки
col3DPyramidPercentStacked  | 3D 100% пирамиды сложены диаграммы столбца
col3DCylinder               | 3D диаграмма цилиндрической колонки
col3DCylinderClustered      | 3D цилиндр кластерных столбцов диаграммы
col3DCylinderStacked        | 3D цилиндр штабелироваться диаграммы колонки
col3DCylinderPercentStacked | 3D 100% цилиндр штабелироваться диаграммы колонки
doughnut                    | диаграмма пончика
line                        | линейный график
pie                         | круговая диаграмма
pie3D                       | 3D круговая диаграмма
pieOfPie                    | Двойная круговая диаграмма
barOfPie                    | Гистограмма круговой диаграммы
radar                       | радиолокационная карта
scatter                     | диаграмма рассеяния
surface3D                   | 3D поверхностная диаграмма
wireframeSurface3D          | 3D диаграмма поверхности проволоки
contour                     | контурная диаграмма
wireframeContour            | диаграмма контура каркасной проволоки
bubble                      | пузырь диаграммы
bubble3D                    | 3D пузырь диаграммы

В области данных диаграммы Office Excel `Series` определяет набор информации, для которой данные рисовать, легенда пункт (серии), и горизонтальной (категория) метки оси.

Параметры `Series`, которые могут быть установлены:

Параметр|Объяснение
---|---
Name|Элемент легенды (серия), отображаемый в легенде диаграммы и в строке формул. Параметр `Name` является необязательным. Если вы не укажете это значение, по умолчанию будет `Series 1 .. n`. `Name` для представления формул, например: `Sheet1!$A$1`.
Categories|Горизонтальная (категория) метка оси. Параметр `Categories` является необязательным в большинстве типов диаграмм, по умолчанию это непрерывная последовательность формы `1..n`.
Values|Область данных диаграммы, которая является наиболее важным параметром в `Series`, является единственным обязательным параметром при создании диаграммы. Этот параметр связывает диаграмму с отображаемыми данными листа.
Line|Устанавливает формат линии графика. Свойство `Line` является необязательным, и если оно не указано, оно будет использовать стиль по умолчанию. Параметры, которые можно установить, это ширина. Диапазон `Width` составляет 0.25pt - 999pt. Если значение ширины находится за пределами диапазона, ширина линии по умолчанию составляет 2pt.
Marker|Это устанавливает маркер линейной диаграммы и точечной диаграммы. Диапазон необязательного поля `Size` составляет от 2 до 72 (значение по умолчанию `5`). Значением перечисления необязательного поля `Symbol` являются (значение по умолчанию - `auto`): `circle`, `dash`, `diamond`, `dot`, `none`, `picture`, `plus`, `square`, `star`, `triangle`, `x`, `auto`.

Задайте свойства легенды диаграммы. Возможные параметры:

Параметр|Тип|Объяснение
---|---|---
Position        | `string` | Позиция легенды диаграммы
ShowLegendKey   | `bool`   | Задайте ключи легенды, которые будут отображаться в метках данных

Установите `Position` легенды диаграммы. Положение легенды по умолчанию - `right`. Доступные позиции:

Параметр | Объяснение
---|---
none      | Выключить легенду
top       | верх
bottom    | дно
left      | оставил
right     | правильно
top_right | в правом верхнем углу

Параметр `ShowLegendKey`, задающий ключи легенды, должен отображаться в метках данных. Значение по умолчанию равно `false`.

Название диаграммы задается путем выбора параметра `Name` объекта `Title`, и заголовок будет отображаться над диаграммой. Параметр `Name` поддерживает использование представлений формул, таких как `Sheet1!$A$1`, если вы не укажете заголовок значка, значение по умолчанию равно null.

Параметр `ShowBlanksAs` предоставляет настройку «Скрыть и пустые ячейки». Значение по умолчанию: `gap` т.е. «пустая ячейка отображается как»: «пространство». Ниже приведены необязательные значения для этого параметра:

Параметр | Объяснение
---|---
gap  | пространство
span | Соединить точки данных с прямыми линиями
zero | нулевое значение

Указывает, что каждый маркер данных в серии имеет различный цвет на `VaryColors`. Значение по умолчанию является `истинным`.

Параметр `Format` предоставляет параметры для таких параметров, как смещение графика, масштаб, параметры соотношения сторон и свойства печати, а также те, которые используются в функции [`AddPicture`](image.md#AddPicture).

Задайте положение области графика по площади участка. Свойства, которые могут быть установлены:

Параметр|Тип|По умолчанию|Объяснение
---|---|---|---
ShowBubbleSize  | `bool` | `false` | Указывает, что размер пузырька должен быть указан на метке данных.
ShowCatName     | `bool` | `false` | Название категории
ShowLeaderLines | `bool` | `false` | Указывает, что имя категории должно отображаться на метке данных.
ShowPercent     | `bool` | `false` | Указывает, что процент отображается в метке данных.
ShowSerName     | `bool` | `false` | Указывает, что имя серии должно отображаться в метке данных.
ShowVal         | `bool` | `false` | Указывает, что значение должно отображаться на метке данных.

Задайте основные параметры горизонтальной и вертикальной оси с помощью `XAxis` и `YAxis`.

Свойства `XAxis`, которые можно установить:

Параметр|Тип|По умолчанию|Объяснение
---|---|---|---
None           | `bool`     | `false` | Отключить оси.
MajorGridLines | `bool`     | `false` | Определяет основные линии сетки.
MinorGridLines | `bool`     | `false` | Определяет второстепенные линии сетки.
TickLabelSkip  | `int`      | `1`     | Определяет, сколько тиковых меток пропустить между нарисованными метками. Свойство `TickLabelSkip` является необязательным. Значением по умолчанию является авто.
ReverseOrder   | `bool`     | `false` | Указывает, что категории или значения в обратном порядке (ориентация диаграммы). Свойство `ReverseOrder` является необязательным.
Maximum        | `*float64` | `0`     | Указывает, что фиксированный максимум 0 автоматически. Максимальное свойство необязательно.
Minimum        | `*float64` | `0`     | Указывает, что фиксированный минимум 0 является авто. Минимальное свойство необязательно. Значение по умолчанию автоматически.

Свойства `YAxis`, которые можно установить:

Параметр|Тип|По умолчанию|Объяснение
---|---|---|---
None           | `bool`     | `false` | Отключить оси.
MajorGridLines | `bool`     | `false` | Определяет основные линии сетки.
MinorGridLines | `bool`     | `false` | Определяет второстепенные линии сетки.
MajorUnit      | `float64`  | `0`     | Определяет расстояние между основными тиками. Должен содержать положительное число с плавающей точкой. Свойство `MajorUnit` является необязательным. Значением по умолчанию является авто.
ReverseOrder   | `bool`     | `false` | Указывает, что категории или значения в обратном порядке (ориентация диаграммы). Свойство `ReverseOrder` является необязательным.
Maximum        | `*float64` | `0`     | Указывает, что фиксированный максимум 0 автоматически. Максимальное свойство необязательно.
Minimum        | `*float64` | `0`     | Указывает, что фиксированный минимум 0 является авто. Минимальное свойство необязательно. Значение по умолчанию автоматически.

Установите размер диаграммы по свойству `Dimension`. Свойство измерения необязательно. Свойства, которые могут быть установлены:

Параметр|Тип|По умолчанию|Объяснение
---|---|---|---
Height | `int` | 290 | Высота
Width  | `int` | 480 | Ширина

Параметр `combo` определяет создание диаграммы, которая объединяет два или более типов диаграммы в одну диаграмму. Например, создайте кластеризованную столбчатую диаграмму с данными `Sheet1!$E$1:$L$15`:

```go
package main

import (
    "fmt"

    "github.com/xuri/excelize/v2"
)

func main() {
    f := excelize.NewFile()
    defer func() {
        if err := f.Close(); err != nil {
            fmt.Println(err)
        }
    }()
    for idx, row := range [][]interface{}{
        {nil, "Apple", "Orange", "Pear"},
        {"Small", 2, 3, 3},
        {"Normal", 5, 2, 4},
        {"Large", 6, 7, 8},
    } {
        cell, err := excelize.CoordinatesToCellName(1, idx+1)
        if err != nil {
            fmt.Println(err)
            return
        }
        if err := f.SetSheetRow("Sheet1", cell, &row); err != nil {
            fmt.Println(err)
            return
        }
    }
    enable, disable := true, false
    if err := f.AddChart("Sheet1", "E1", &excelize.Chart{
        Type: "col",
        Series: []excelize.ChartSeries{
            {
                Name:       "Sheet1!$A$2",
                Categories: "Sheet1!$B$1:$D$1",
                Values:     "Sheet1!$B$2:$D$2",
            },
        },
        Format: excelize.GraphicOptions{
            ScaleX:          1,
            ScaleY:          1,
            OffsetX:         15,
            OffsetY:         10,
            PrintObject:     &enable,
            LockAspectRatio: false,
            Locked:          &disable,
        },
        Title: excelize.ChartTitle{
            Name: "2D группированная диаграмма столбцов - линейный график",
        },
        Legend: excelize.ChartLegend{
            Position: "left",
        },
        PlotArea: excelize.ChartPlotArea{
            ShowCatName:     false,
            ShowLeaderLines: false,
            ShowPercent:     true,
            ShowSerName:     true,
            ShowVal:         true,
        },
    }, &excelize.Chart{
        Type: "line",
        Series: []excelize.ChartSeries{
            {
                Name:       "Sheet1!$A$4",
                Categories: "Sheet1!$B$1:$D$1",
                Values:     "Sheet1!$B$4:$D$4",
                Marker: excelize.ChartMarker{
                    Symbol: "none", Size: 10,
                },
            },
        },
        Format: excelize.GraphicOptions{
            ScaleX:          1,
            ScaleY:          1,
            OffsetX:         15,
            OffsetY:         10,
            PrintObject:     &enable,
            LockAspectRatio: false,
            Locked:          &disable,
        },
        Legend: excelize.ChartLegend{
            Position: "right",
        },
        PlotArea: excelize.ChartPlotArea{
            ShowCatName:     false,
            ShowLeaderLines: false,
            ShowPercent:     true,
            ShowSerName:     true,
            ShowVal:         true,
        },
    }); err != nil {
        fmt.Println(err)
        return
    }
    // Сохранить workbook
    if err := f.SaveAs("Book1.xlsx"); err != nil {
        fmt.Println(err)
    }
}
```

## Добавить лист диаграммы {#AddChartSheet}

```go
func (f *File) AddChartSheet(sheet string, chart *ChartOptions, combo ...*ChartOptions) error
```

AddChartSheet предоставляет метод для создания листа диаграммы по заданному набору формата диаграммы (например, смещение, масштаб, настройка соотношения сторон и настройки печати) и набору свойств. В Excel лист диаграммы - это рабочий лист, который содержит только диаграмму.

## Удалить диаграмму {#DeleteChart}

```go
func (f *File) DeleteChart(sheet, cell string) error
```

DeleteChart предоставляет функцию для удаления диаграммы в XLSX по заданному рабочему листу и имени ячейки.
